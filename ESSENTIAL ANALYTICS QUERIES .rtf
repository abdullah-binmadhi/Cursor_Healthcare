{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;\f1\fnil\fcharset0 Menlo-Italic;}
{\colortbl;\red255\green255\blue255;\red184\green93\blue213;\red36\green36\blue35;\red155\green162\blue177;
\red81\green157\blue235;\red136\green185\blue102;\red197\green136\blue83;\red74\green80\blue93;}
{\*\expandedcolortbl;;\cssrgb\c77647\c47059\c86667;\cssrgb\c18824\c18824\c18039;\cssrgb\c67059\c69804\c74902;
\cssrgb\c38039\c68627\c93725;\cssrgb\c59608\c76471\c47451;\cssrgb\c81961\c60392\c40000;\cssrgb\c36078\c38824\c43922;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs35 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 SELECT\cf4 \strokec4  \
    department,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  current_patients,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (julianday(\cf6 \strokec6 'now'\cf4 \strokec4 ) \cf5 \strokec5 -\cf4 \strokec4  julianday(admission_date)), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_days_admitted\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  discharge_date \cf5 \strokec5 IS\cf4 \strokec4  \cf7 \strokec7 NULL\cf4 \strokec4 \
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  department\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  current_patients \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 2. Monthly admission trends (last 12 months)
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    strftime(\cf6 \strokec6 '%Y-%m'\cf4 \strokec4 , admission_date) \cf2 \strokec2 as\cf4 \strokec4  \cf2 \strokec2 month\cf4 \strokec4 ,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  admissions,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  admission_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-12 months'\cf4 \strokec4 )\
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  strftime(\cf6 \strokec6 '%Y-%m'\cf4 \strokec4 , admission_date)\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  \cf2 \strokec2 month\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 3. Top diagnoses by volume
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    d.diagnosis_description,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  case_count,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (a.length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (fd.net_revenue), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_revenue\
\cf2 \strokec2 FROM\cf4 \strokec4  diagnoses d\
\cf2 \strokec2 JOIN\cf4 \strokec4  admissions a \cf2 \strokec2 ON\cf4 \strokec4  d.admission_id \cf5 \strokec5 =\cf4 \strokec4  a.admission_id\
\cf2 \strokec2 JOIN\cf4 \strokec4  financial_data fd \cf2 \strokec2 ON\cf4 \strokec4  a.admission_id \cf5 \strokec5 =\cf4 \strokec4  fd.admission_id\
\cf2 \strokec2 WHERE\cf4 \strokec4  d.diagnosis_type \cf5 \strokec5 =\cf4 \strokec4  \cf6 \strokec6 'Primary'\cf4 \strokec4 \
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  d.diagnosis_description\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  case_count \cf2 \strokec2 DESC\cf4 \strokec4 \
\cf2 \strokec2 LIMIT\cf4 \strokec4  \cf7 \strokec7 20\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 4. Readmission analysis (last 30 days)
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    a.department,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 DISTINCT\cf4 \strokec4  a.admission_id) \cf2 \strokec2 as\cf4 \strokec4  total_discharges,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (r.readmission_id) \cf2 \strokec2 as\cf4 \strokec4  readmissions,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\
        \cf2 \strokec2 CASE\cf4 \strokec4  \
            \cf2 \strokec2 WHEN\cf4 \strokec4  \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 DISTINCT\cf4 \strokec4  a.admission_id) \cf5 \strokec5 >\cf4 \strokec4  \cf7 \strokec7 0\cf4 \strokec4  \cf2 \strokec2 THEN\cf4 \strokec4  \
                (CAST(\cf5 \strokec5 COUNT\cf4 \strokec4 (r.readmission_id) \cf2 \strokec2 AS\cf4 \strokec4  \cf2 \strokec2 REAL\cf4 \strokec4 ) \cf5 \strokec5 *\cf4 \strokec4  \cf7 \strokec7 100.0\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 DISTINCT\cf4 \strokec4  a.admission_id))\
            \cf2 \strokec2 ELSE\cf4 \strokec4  \cf7 \strokec7 0\cf4 \strokec4  \
        \cf2 \strokec2 END\cf4 \strokec4 , \cf7 \strokec7 2\cf4 \strokec4 \
    ) \cf2 \strokec2 as\cf4 \strokec4  readmission_rate\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions a\
\cf2 \strokec2 LEFT\cf4 \strokec4  \cf2 \strokec2 JOIN\cf4 \strokec4  readmissions r \cf2 \strokec2 ON\cf4 \strokec4  a.admission_id \cf5 \strokec5 =\cf4 \strokec4  r.original_admission_id\
\cf2 \strokec2 WHERE\cf4 \strokec4  a.discharge_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-30 days'\cf4 \strokec4 )\
  \cf5 \strokec5 AND\cf4 \strokec4  a.discharge_date \cf5 \strokec5 IS\cf4 \strokec4  \cf5 \strokec5 NOT\cf4 \strokec4  \cf7 \strokec7 NULL\cf4 \strokec4 \
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  a.department\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  readmission_rate \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 5. Patient satisfaction by department (last 90 days)
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    a.department,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (qm.metric_id) \cf2 \strokec2 as\cf4 \strokec4  surveys_completed,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (qm.patient_satisfaction_score), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_satisfaction,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (qm.communication_score), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_communication,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (qm.pain_management_score), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_pain_mgmt\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions a\
\cf2 \strokec2 JOIN\cf4 \strokec4  quality_metrics qm \cf2 \strokec2 ON\cf4 \strokec4  a.admission_id \cf5 \strokec5 =\cf4 \strokec4  qm.admission_id\
\cf2 \strokec2 WHERE\cf4 \strokec4  qm.survey_completion_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-90 days'\cf4 \strokec4 )\
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  a.department\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  avg_satisfaction \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- ====================
\f0\i0 \cf4 \strokec4 \

\f1\i \cf8 \strokec8 -- ADDITIONAL USEFUL ANALYTICS QUERIES
\f0\i0 \cf4 \strokec4 \

\f1\i \cf8 \strokec8 -- ====================
\f0\i0 \cf4 \strokec4 \
\

\f1\i \cf8 \strokec8 -- 6. Daily admission volume trend (last 30 days)
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    \cf2 \strokec2 date\cf4 \strokec4 (admission_date) \cf2 \strokec2 as\cf4 \strokec4  admission_day,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  daily_admissions,\
    strftime(\cf6 \strokec6 '%w'\cf4 \strokec4 , admission_date) \cf2 \strokec2 as\cf4 \strokec4  day_of_week  
\f1\i \cf8 \strokec8 -- 0=Sunday, 1=Monday, etc.
\f0\i0 \cf4 \strokec4 \
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  admission_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-30 days'\cf4 \strokec4 )\
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (admission_date)\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  admission_day \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 7. Length of stay distribution by department
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    department,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  total_cases,\
    \cf5 \strokec5 MIN\cf4 \strokec4 (length_of_stay) \cf2 \strokec2 as\cf4 \strokec4  min_los,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los,\
    \cf5 \strokec5 MAX\cf4 \strokec4 (length_of_stay) \cf2 \strokec2 as\cf4 \strokec4  max_los,\
    
\f1\i \cf8 \strokec8 -- Quartiles approximation
\f0\i0 \cf4 \strokec4 \
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 CASE\cf4 \strokec4  \cf2 \strokec2 WHEN\cf4 \strokec4  length_of_stay \cf5 \strokec5 <=\cf4 \strokec4  \cf7 \strokec7 2\cf4 \strokec4  \cf2 \strokec2 THEN\cf4 \strokec4  \cf7 \strokec7 1\cf4 \strokec4  \cf2 \strokec2 END\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  short_stay_count,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 CASE\cf4 \strokec4  \cf2 \strokec2 WHEN\cf4 \strokec4  length_of_stay \cf5 \strokec5 >\cf4 \strokec4  \cf7 \strokec7 7\cf4 \strokec4  \cf2 \strokec2 THEN\cf4 \strokec4  \cf7 \strokec7 1\cf4 \strokec4  \cf2 \strokec2 END\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  long_stay_count\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  discharge_date \cf5 \strokec5 IS\cf4 \strokec4  \cf5 \strokec5 NOT\cf4 \strokec4  \cf7 \strokec7 NULL\cf4 \strokec4 \
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  department\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  avg_los \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 8. Revenue analysis by insurance type
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    p.insurance_type,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  case_count,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (fd.net_revenue), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_revenue,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 SUM\cf4 \strokec4 (fd.net_revenue), \cf7 \strokec7 2\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  total_revenue,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (a.length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los\
\cf2 \strokec2 FROM\cf4 \strokec4  patients p\
\cf2 \strokec2 JOIN\cf4 \strokec4  admissions a \cf2 \strokec2 ON\cf4 \strokec4  p.patient_id \cf5 \strokec5 =\cf4 \strokec4  a.patient_id\
\cf2 \strokec2 JOIN\cf4 \strokec4  financial_data fd \cf2 \strokec2 ON\cf4 \strokec4  a.admission_id \cf5 \strokec5 =\cf4 \strokec4  fd.admission_id\
\cf2 \strokec2 WHERE\cf4 \strokec4  a.discharge_date \cf5 \strokec5 IS\cf4 \strokec4  \cf5 \strokec5 NOT\cf4 \strokec4  \cf7 \strokec7 NULL\cf4 \strokec4 \
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  p.insurance_type\
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  total_revenue \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 9. High-volume physicians
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    physician_name,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  total_cases,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf2 \strokec2 CASE\cf4 \strokec4  \cf2 \strokec2 WHEN\cf4 \strokec4  discharge_date \cf5 \strokec5 IS\cf4 \strokec4  \cf7 \strokec7 NULL\cf4 \strokec4  \cf2 \strokec2 THEN\cf4 \strokec4  \cf7 \strokec7 1\cf4 \strokec4  \cf2 \strokec2 END\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  current_patients\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  admission_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-90 days'\cf4 \strokec4 )\
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  physician_name\
\cf2 \strokec2 HAVING\cf4 \strokec4  \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf5 \strokec5 >=\cf4 \strokec4  \cf7 \strokec7 5\cf4 \strokec4   
\f1\i \cf8 \strokec8 -- Only physicians with 5+ cases
\f0\i0 \cf4 \strokec4 \
\cf2 \strokec2 ORDER\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  total_cases \cf2 \strokec2 DESC\cf4 \strokec4 ;\
\
\pard\pardeftab720\partightenfactor0

\f1\i \cf8 \strokec8 -- 10. Weekend vs Weekday admissions
\f0\i0 \cf4 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \strokec2 SELECT\cf4 \strokec4  \
    \cf2 \strokec2 CASE\cf4 \strokec4  \
        \cf2 \strokec2 WHEN\cf4 \strokec4  strftime(\cf6 \strokec6 '%w'\cf4 \strokec4 , admission_date) \cf5 \strokec5 IN\cf4 \strokec4  (\cf6 \strokec6 '0'\cf4 \strokec4 , \cf6 \strokec6 '6'\cf4 \strokec4 ) \cf2 \strokec2 THEN\cf4 \strokec4  \cf6 \strokec6 'Weekend'\cf4 \strokec4 \
        \cf2 \strokec2 ELSE\cf4 \strokec4  \cf6 \strokec6 'Weekday'\cf4 \strokec4 \
    \cf2 \strokec2 END\cf4 \strokec4  \cf2 \strokec2 as\cf4 \strokec4  day_type,\
    \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  admission_count,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 AVG\cf4 \strokec4 (length_of_stay), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  avg_los,\
    \cf5 \strokec5 ROUND\cf4 \strokec4 (\cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf5 \strokec5 *\cf4 \strokec4  \cf7 \strokec7 100.0\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  (\cf2 \strokec2 SELECT\cf4 \strokec4  \cf5 \strokec5 COUNT\cf4 \strokec4 (\cf5 \strokec5 *\cf4 \strokec4 ) \cf2 \strokec2 FROM\cf4 \strokec4  admissions \cf2 \strokec2 WHERE\cf4 \strokec4  admission_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-90 days'\cf4 \strokec4 )), \cf7 \strokec7 1\cf4 \strokec4 ) \cf2 \strokec2 as\cf4 \strokec4  percentage\
\cf2 \strokec2 FROM\cf4 \strokec4  admissions \
\cf2 \strokec2 WHERE\cf4 \strokec4  admission_date \cf5 \strokec5 >=\cf4 \strokec4  \cf2 \strokec2 date\cf4 \strokec4 (\cf6 \strokec6 'now'\cf4 \strokec4 , \cf6 \strokec6 '-90 days'\cf4 \strokec4 )\
\cf2 \strokec2 GROUP\cf4 \strokec4  \cf2 \strokec2 BY\cf4 \strokec4  day_type;\
}